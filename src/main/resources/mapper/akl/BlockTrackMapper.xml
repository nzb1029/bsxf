<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.bsxf.common.repository.akl.BlockTrackMybatisDao">
   <sql id="blockTrackSql">
 select s.id,
		p.id as 'block.id',
		p.name as 'block.name',
		p.monitorSite as 'block.monitorSite',
		s.create_time as  createTime ,
		s.zwfz,
		s.bchyj,
		s.bcfzfa,
		s.yjshsj,
		s.bzgzjy,
		s.field01,
		s.field02,
		s.field03
		from akl_block_track s 
		 left join akl_block p on p.id=s.block_id
		where 1=1 
	</sql>
	
	  <select id="getAllBlockTrack" parameterType="string" resultType="BlockTrack">
		<include refid="blockTrackSql"/>
		 
	</select>
	
	  <select id="getTrackListByBlockId" parameterType="string" resultType="BlockTrack">
		<include refid="blockTrackSql"/>
		 and s.block_id=#{blockId}
		 order by s.create_time desc
	</select>
	
    <select id="getBlockTrack" parameterType="string" resultType="BlockTrack">
		<include refid="blockTrackSql"/>
		  and  s.id=#{id}
	</select>
	
	<select id="findBlockTrackByFilter" parameterType="Page" resultType="BlockTrack">
		<include refid="blockTrackSql"/>
		<if test="filters.blockName!=null"> 
			 and p.name like '%' #{filters.blockName} '%'
		</if>
		<if test="orderBy!=null">
	      order by ${orderBy} ${order}
	   </if>
	      limit #{start},#{pageSize}
	</select>
	
	<select id="findBlockTrackCountByFilter" parameterType="Page" resultType="int">
	     select count(1) from (	
	     <include refid="blockTrackSql"/>
		  	<if test="filters.blockName!=null"> 
			   and p.name like '%' #{filters.blockName} '%'
			</if>
			<if test="orderBy!=null">
		      order by ${orderBy} ${order}
		   </if>
	     )t
	</select>
	<insert id="saveBlockTrack" parameterType="BlockTrack">
		insert into akl_block_track (id,
			block_id,
			create_time,
			zwfz,
			bchyj,
			bcfzfa,
			yjshsj,
			bzgzjy,
		    field01,
		    field02,
		    field03
		    ) 
		 values(#{id},
			#{block.id},
			#{createTime},
			#{zwfz},
			#{bchyj},
			#{bcfzfa},
			#{yjshsj},
			#{bzgzjy},
		    #{field01},
		    #{field02},
		    #{field03}
			)
	</insert>
	<update id="updateBlockTrack" parameterType="BlockTrack">
		update akl_block_track set 
			block_id = #{block.id},   
			create_time     =#{createTime},
			zwfz     = #{zwfz},  
			bchyj    = #{bchyj}, 
			bcfzfa   = #{bcfzfa},
			yjshsj   = #{yjshsj},
			bzgzjy   = #{bzgzjy},
			field01          =#{field01},      
			field02          =#{field02},      
			field03          =#{field03}       
		 where id=#{id} 
	</update>
	 <delete id="deleteBlockTrack" >
	    delete from   akl_block_track  where id in 
	  <foreach  item="item" index="index" collection="list"
     	 open="(" separator="," close=")">
       		 #{item}
  	 </foreach> 
	</delete>	
</mapper>